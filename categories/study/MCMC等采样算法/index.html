<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
<title>MCMC等采样算法 - 陈燊的博客</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta name="description" content="直接采样直接采样的思想是，通过对均匀分布采样，实现对任意分布的采样。因为均匀分布采样好猜，我们想要的分布采样不好采，那就采取一定的策略通过简单采取求复杂采样。假设y服从某项分布p(y)，其累积分布函数CDF为h(y)，有样本z~Uniform(0,1)，我们令 z = h(y)，即 y = h(z)^(-1)，结果y即为对分布p(y)的采样。">
<meta name="keywords" content="采样">
<meta property="og:type" content="article">
<meta property="og:title" content="MCMC等采样算法">
<meta property="og:url" content="http://chenshen.xyz/categories/study/MCMC等采样算法/index.html">
<meta property="og:site_name" content="陈燊的博客">
<meta property="og:description" content="直接采样直接采样的思想是，通过对均匀分布采样，实现对任意分布的采样。因为均匀分布采样好猜，我们想要的分布采样不好采，那就采取一定的策略通过简单采取求复杂采样。假设y服从某项分布p(y)，其累积分布函数CDF为h(y)，有样本z~Uniform(0,1)，我们令 z = h(y)，即 y = h(z)^(-1)，结果y即为对分布p(y)的采样。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://user-images.githubusercontent.com/20432947/52462693-1601d200-2baf-11e9-9d98-ecb4d6060dc7.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/20432947/52462717-3336a080-2baf-11e9-97b4-704e8e0ac3f2.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/20432947/52462754-5feab800-2baf-11e9-8f92-49296ccbd746.png">
<meta property="og:image" content="https://ws3.sinaimg.cn/large/006tNbRwgy1fxa4p5xb3qj30ge09gt9h.jpg">
<meta property="og:image" content="https://ws3.sinaimg.cn/large/006tNbRwgy1fxa4o7nso1j30960693yq.jpg">
<meta property="og:image" content="https://ws1.sinaimg.cn/large/006tNbRwgy1fxa4ogzk3dj30m209gkd4.jpg">
<meta property="og:image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fxb60s6q2sj30if0cbmyc.jpg">
<meta property="og:image" content="https://ws2.sinaimg.cn/large/006tNbRwgy1fxb614xpuwj30i20hzwgo.jpg">
<meta property="og:image" content="http://cos.name/wp-content/uploads/2013/01/mcmc-algo-1.jpg">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105185946590-1126786209.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105185952733-2058071248.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105190002187-28177626.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105190015327-958250173.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105190047964-1071205782.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105190055812-1550383359.png">
<meta property="og:updated_time" content="2019-09-04T13:39:51.674Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MCMC等采样算法">
<meta name="twitter:description" content="直接采样直接采样的思想是，通过对均匀分布采样，实现对任意分布的采样。因为均匀分布采样好猜，我们想要的分布采样不好采，那就采取一定的策略通过简单采取求复杂采样。假设y服从某项分布p(y)，其累积分布函数CDF为h(y)，有样本z~Uniform(0,1)，我们令 z = h(y)，即 y = h(z)^(-1)，结果y即为对分布p(y)的采样。">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/20432947/52462693-1601d200-2baf-11e9-9d98-ecb4d6060dc7.png">





<link rel="icon" href="/images/favicon.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    

    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-2-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="MCMC等采样算法" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item" href="/">主页</a>
                
                <a class="navbar-item" href="/archives">归档</a>
                
                <a class="navbar-item" href="/categories">分类</a>
                
                <a class="navbar-item" href="/tags">标签</a>
                
                <a class="navbar-item" href="/about">关于</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-9-tablet is-9-desktop is-9-widescreen has-order-2 column-main"><div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-11-15T14:25:22.000Z">2018-11-15</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/study/">学习</a>
                </div>
                
                
                
                <span class="level-item has-text-grey" id="busuanzi_container_page_pv">
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv">0</span>次访问
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                MCMC等采样算法
            
        </h1>
        <div class="content">
            <h2 id="直接采样"><a href="#直接采样" class="headerlink" title="直接采样"></a>直接采样</h2><p>直接采样的思想是，通过对均匀分布采样，实现对任意分布的采样。因为均匀分布采样好猜，我们想要的分布采样不好采，那就采取一定的策略通过简单采取求复杂采样。<br>假设y服从某项分布p(y)，其累积分布函数CDF为h(y)，有样本z~Uniform(0,1)，我们令 z = h(y)，即 y = h(z)^(-1)，结果y即为对分布p(y)的采样。</p>
<p><img src="https://user-images.githubusercontent.com/20432947/52462693-1601d200-2baf-11e9-9d98-ecb4d6060dc7.png" alt="image"></p>
<a id="more"></a>
<p>直接采样的核心思想在与CDF以及逆变换的应用。在原分布p(y)中，如果某个区域[a, b]的分布较多，然后对应在CDF曲线中，[h(a), h(b)]的曲线斜率便较大。那么，经过逆变换之后，对y轴（z）进行均匀分布采样时，分布多的部分（占据y轴部分多）对应抽样得到的概率便更大，</p>
<h3 id="局限性"><a href="#局限性" class="headerlink" title="局限性"></a>局限性</h3><p>实际中，所有采样的分布都较为复杂，CDF的求解和反函数的求解都不太可行。</p>
<h2 id="拒绝采样"><a href="#拒绝采样" class="headerlink" title="拒绝采样"></a>拒绝采样</h2><p>拒绝采样是由一个易于采样的分布出发，为一个难以直接采样的分布产生采样样本的通用算法。既然 p(x) 太复杂在程序中没法直接采样，那么便一个可抽样的分布 q(x) 比如高斯分布，然后按照一定的方法拒绝某些样本，达到接近 p(x) 分布的目的。</p>
<p><img src="https://user-images.githubusercontent.com/20432947/52462717-3336a080-2baf-11e9-97b4-704e8e0ac3f2.png" alt="image"></p>
<h3 id="计算步骤"><a href="#计算步骤" class="headerlink" title="计算步骤"></a>计算步骤</h3><p>设定一个方便抽样的函数 q(x)，以及一个常量 k，使得 p(x) 总在 k*q(x) 的下方。（参考上图）</p>
<ul>
<li>x 轴方向：从 q(x) 分布抽样得到 a；</li>
<li>y 轴方向：从均匀分布（0, k*q(a)) 中抽样得到 u；</li>
<li>如果刚好落到灰色区域： u &gt; p(a), 拒绝， 否则接受这次抽样；</li>
<li>重复以上过程。</li>
</ul>
<h3 id="计算步骤（BN）"><a href="#计算步骤（BN）" class="headerlink" title="计算步骤（BN）"></a>计算步骤（BN）</h3><ul>
<li>根据网络指定的先验概率分布生成采样样本；</li>
<li>拒绝所有与证据不匹配的样本；</li>
<li>在剩余样本中对事件X=x的出现频繁程度计数从而得到估计概率、</li>
</ul>
<h3 id="局限性-1"><a href="#局限性-1" class="headerlink" title="局限性"></a>局限性</h3><ul>
<li>拒绝了太多的样本！随着证据变量个数的增多，与证据e相一致的样本在所有样本中所占的比例呈指数级下降，所以对于复杂问题这种方法是完全不可用的。</li>
<li>难以找到合适的k*q(a)，接受概率可能会很低。</li>
</ul>
<h2 id="重要性采样（似然加权）"><a href="#重要性采样（似然加权）" class="headerlink" title="重要性采样（似然加权）"></a>重要性采样（似然加权）</h2><blockquote>
<p><a href="https://pubweb.eng.utah.edu/~mccully/cs5300lw/" target="_blank" rel="noopener">Likelihood Weighting</a></p>
</blockquote>
<p>重要性采样主要是用于求一个复杂分布p(x)的<strong>均值</strong>，最后并没有得到样本。 </p>
<p>重要性采样的思想是借助一个易于采样的简单分布q(x)，对这个简单分布q(x)所得到的样本全部接受。但是以此得到的样本肯定不满足分布p(x)，因此需要对每一个样本附加相应的重要性权重。在重要性采样中，以p(x0)/q(x0)的值作为每个样本的权重。这样，当样本和分布p(x)相近时，对应的权重大；与分布p(x)相差过多时，对应的权重小。这个方法采样得到的是带有重要性权重的服从q(z)分布的样本，这个权重乘以样本之后的结果其实就是服从p(z)分布的。</p>
<p><img src="https://user-images.githubusercontent.com/20432947/52462754-5feab800-2baf-11e9-8f92-49296ccbd746.png" alt="image"></p>
<p>通过上述公式，我们可以知道重要性采样可以用于近似复杂分布的均值。</p>
<h2 id="吉布斯采样"><a href="#吉布斯采样" class="headerlink" title="吉布斯采样"></a>吉布斯采样</h2><p>假设有一个例子：E：吃饭、学习、打球；时间T：上午、下午、晚上；天气W：晴朗、刮风、下雨。样本（E，T，W）满足一定的概率分布。现要对其进行采样，如：打球+下午+晴朗。</p>
<p>问题是我们不知道p(E,T,W)，或者说，不知道三件事的联合分布。当然，如果知道的话，就没有必要用吉布斯采样了。但是，我们知道三件事的条件分布。也就是说，p(E|T,W), p(T|E,W), p(W|E,T)。现在要做的就是通过这三个已知的条件分布，再用Gibbs sampling的方法，得到联合分布。<br>具体方法：首先随便初始化一个组合,i.e. 学习+晚上+刮风，然后依条件概率改变其中的一个变量。具体说，假设我们知道晚上+刮风，我们给E生成一个变量，比如，学习→吃饭。我们再依条件概率改下一个变量，根据学习+刮风，把晚上变成上午。类似地，把刮风变成刮风（当然可以变成相同的变量）。这样学习+晚上+刮风→吃饭+上午+刮风。同样的方法，得到一个序列，每个单元包含三个变量，也就是一个马尔可夫链。然后跳过初始的一定数量的单元（比如100个），然后隔一定的数量取一个单元（比如隔20个取1个）。这样sample到的单元，是逼近联合分布的。</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fxa4p5xb3qj30ge09gt9h.jpg" alt="25225719-116e5550e9fd448f894cddc6b6ab02b4"></p>
<h2 id="蓄水池采样"><a href="#蓄水池采样" class="headerlink" title="蓄水池采样"></a>蓄水池采样</h2><p>蓄水池抽样（Reservoir Sampling ），即能够在o（n）时间内对n个数据进行等概率随机抽取，例如：从1000个数据中等概率随机抽取出100个。另外，如果数据集合的量特别大或者还在增长（相当于未知数据集合总量），该算法依然可以等概率抽样。</p>
<h3 id="算法步骤："><a href="#算法步骤：" class="headerlink" title="算法步骤："></a>算法步骤：</h3><ul>
<li>先选取数据流中的前k个元素，保存在集合A中；</li>
<li>从第j（k + 1 &lt;= j &lt;= n）个元素开始，每次先以概率p = k/j选择是否让第j个元素留下。若j被选中，则从A中随机选择一个元素并用该元素j替换它；否则直接淘汰该元素；</li>
<li>重复步骤2直到结束，最后集合A中剩下的就是保证随机抽取的k个元素。</li>
</ul>
<h2 id="MCMC算法"><a href="#MCMC算法" class="headerlink" title="MCMC算法"></a>MCMC算法</h2><blockquote>
<p><a href="https://blog.csdn.net/pipisorry/article/details/51373090" target="_blank" rel="noopener">随机采样和随机模拟：吉布斯采样Gibbs Sampling</a></p>
<p><a href="https://blog.csdn.net/zongzi13545329/article/details/63685816" target="_blank" rel="noopener">MCMC算法学习总结</a></p>
<p><a href="https://blog.csdn.net/Dark_Scope/article/details/78937731" target="_blank" rel="noopener">【重点】采样方法（二）MCMC相关算法介绍及代码实现</a></p>
</blockquote>
<h3 id="马氏链收敛定理"><a href="#马氏链收敛定理" class="headerlink" title="马氏链收敛定理"></a>马氏链收敛定理</h3><p><strong>马氏链定理：</strong>如果一个非周期马氏链具有转移概率矩阵P,且它的任何两个状态是连通的，那么$\lim<em>{p\to\infty}P</em>{ij}^n$存在且与i无关，记$\lim<em>{p\to\infty}P</em>{ij}^n = \pi(j)$，我们有：</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fxa4o7nso1j30960693yq.jpg" alt="20180604161544272"></p>
<p>其中$\pi = [\pi(1), \pi(2), … , \pi(j), …], \sum_{i=0}^{\infty}\pi_i = 1, \pi$称为马氏链的平稳分布。</p>
<p>所有的 MCMC(Markov Chain Monte Carlo) 方法都是以这个定理作为理论基础的。</p>
<p><strong>说明：</strong></p>
<ol>
<li>该定理中马氏链的状态不要求有限，可以是有无穷多个的；</li>
<li>定理中的“非周期“这个概念不解释，因为我们遇到的绝大多数马氏链都是非周期的；</li>
</ol>
<p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fxa4ogzk3dj30m209gkd4.jpg" alt="20180604161729263"></p>
<h3 id="细致平稳条件"><a href="#细致平稳条件" class="headerlink" title="细致平稳条件"></a>细致平稳条件</h3><p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fxb60s6q2sj30if0cbmyc.jpg" alt="012132441751392"></p>
<p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fxb614xpuwj30i20hzwgo.jpg" alt="012132476599223"></p>
<blockquote>
<p><strong>针对一个新的分布，如何构造对应的转移矩阵？</strong></p>
<p>对于一个分布$\pi(x)$，根据<strong>细致平稳条件</strong>，如果构造的转移矩阵P满足$\pi(i)P<em>{ij} = \pi(j)P</em>{ji}$，那么$\pi(x)$即为该马氏链的平稳分布，因此可以根据这个条件去构造转移矩阵。</p>
<p>通常情况下，初始的转移矩阵$P$一般不满足细致平稳条件，因此我们通过引入接受率构造出新的转移矩阵$P’$，使其和$\pi(x)$满足细致平稳条件。由此，我们便可以用任何转移概率矩阵（均匀分布、高斯分布）作为状态间的转移概率。</p>
<p>如果我们假设状态之间的转移概率是相同的，那么在算法实现时，接收率可以简单得用$\pi(j)/\pi(i)$表示。</p>
</blockquote>
<h3 id="Metropolis-Hastings采样"><a href="#Metropolis-Hastings采样" class="headerlink" title="Metropolis-Hastings采样"></a>Metropolis-Hastings采样</h3><p>对于给定的概率分布p(x),我们希望能有便捷的方式生成它对应的样本。由于马氏链能收敛到平稳分布， 于是一个很的漂亮想法是：如果我们能构造一个转移矩阵为P的马氏链，使得该马氏链的平稳分布恰好是p(x), 那么我们从任何一个初始状态x0出发沿着马氏链转移, 得到一个转移序列 x0,x1,x2,⋯xn,xn+1⋯,， 如果马氏链在第n步已经收敛了，于是我们就得到了 π(x) 的样本xn,xn+1⋯。</p>
<p><img src="http://cos.name/wp-content/uploads/2013/01/mcmc-algo-1.jpg" alt></p>
<p>在马尔科夫状态链中，每一个状态代表一个样本$x_n$，即所有变量的赋值情况。</p>
<p>通过分析MCMC源码，可以知道：假设状态间的转移概率相同，那么下一个样本的采样会依赖于上一个样本。假设上一个样本所对应的原始分布概率$\pi(x)$很小，那么下一个样本的接受率很大概率为1；反之如果上一个样本的原始分布概率$\pi(x)$很大，那么下一个样本会有挺大概率被拒绝。这样的机制保证了生成的样本服从分布$\pi(x)$。</p>
<p>从上述分析可以看出，假如初始状态的样本对应的分布概率很小，那么在算法刚开始运行时所产生的样本（即使是分布概率很小的样本）很大可能都会被接收，从而使得算法刚开始运行时采样的样本不满足原始分布$\pi(x)$。只要算法采样到分布概率大的样本（<strong>此时即为收敛！</strong>），那么之后所采样得到的样本就会基本服从原始分布。当然，从初始状态遍历到分布概率大的状态时需要运行一段时间，这段过程即为收敛的过程。MCMC算法在收敛之后，保证了在分布概率$\pi(x)$大的地方产生更多的样本，在分布概率$\pi(x)$小的地方产生较少的样本。</p>
<p>一个马尔可夫链需要经过多次的状态转移过程采用达到一个稳定状态，这时候采样才比较接近真实的分布。此过程称为<em>burn in</em>。一般可通过丢弃前面的N个采样结果来达到burn in。</p>
<h3 id="疑问"><a href="#疑问" class="headerlink" title="疑问"></a>疑问</h3><ul>
<li><p>MCMC的收敛是什么意思？这个过程中是什么参数会更新导致收敛？如何确定何时收敛？</p>
<p>收敛过程没有参数会更新，收敛的思想类似于大数定理。应用MCMC算法采样时，初始的样本量少，服从的分布可能和复杂分布$\pi(x)$相差挺远，但随着状态转移数的增加（转移矩阵P的应用），根据上述定理的证明，最终的样本分布会逐渐服从复杂分布$\pi(x)$。</p>
</li>
<li><p>$\pi$是每个状态所对应的概率分布吗？如果是的话，初始选定一个状态后，这个$\pi$如何设定？或则在MCMC证明过程中，初始$\pi$的概率分布如何设置？</p>
<p>在MCMC的证明过程中，$\pi$是每个状态所对应的概率分布。证明中所给定的初始$\pi$应该只是为了证明无论初始样本符合什么分布，在经过一定数量的转移之后，得到的样本会服从复杂分布$\pi (x)$，在实际代码实现中，不用对这个$\pi$进行设定。</p>
</li>
</ul>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np</span><br><span class="line"><span class="hljs-keyword">import</span> random</span><br><span class="line"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt</span><br><span class="line"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pdf</span><br></pre></td></tr></table></figure>
<h3 id="Rejection-Sampling"><a href="#Rejection-Sampling" class="headerlink" title="Rejection Sampling"></a>Rejection Sampling</h3><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span><span class="hljs-params">(x)</span>:</span></span><br><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt;= x <span class="hljs-keyword">and</span> x &lt;= <span class="hljs-number">0.25</span>:</span><br><span class="line">        y = <span class="hljs-number">8</span> * x</span><br><span class="line">    <span class="hljs-keyword">elif</span> <span class="hljs-number">0.25</span> &lt; x <span class="hljs-keyword">and</span> x &lt;= <span class="hljs-number">1</span>:</span><br><span class="line">        y = (<span class="hljs-number">1</span> - x) * <span class="hljs-number">8</span>/<span class="hljs-number">3</span></span><br><span class="line">    <span class="hljs-keyword">else</span>:</span><br><span class="line">        y = <span class="hljs-number">0</span></span><br><span class="line">    <span class="hljs-keyword">return</span> y</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">g</span><span class="hljs-params">(x)</span>:</span></span><br><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt;= x <span class="hljs-keyword">and</span> x &lt;= <span class="hljs-number">1</span>:</span><br><span class="line">        y = <span class="hljs-number">1</span></span><br><span class="line">    <span class="hljs-keyword">else</span>:</span><br><span class="line">        y = <span class="hljs-number">0</span></span><br><span class="line">    <span class="hljs-keyword">return</span> y</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot</span><span class="hljs-params">(fun)</span>:</span></span><br><span class="line">    X = np.arange(<span class="hljs-number">0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">0.01</span>)</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> X:</span><br><span class="line">        Y.append(fun(x))</span><br><span class="line">    plt.plot(X, Y)</span><br><span class="line">    plt.xlabel(<span class="hljs-string">"x"</span>)</span><br><span class="line">    plt.ylabel(<span class="hljs-string">"y"</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plot(f)</span><br><span class="line">plot(g)</span><br></pre></td></tr></table></figure>
<p><img src="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105185946590-1126786209.png" alt><br><img src="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105185952733-2058071248.png" alt></p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rejection_sampling</span><span class="hljs-params">(N=<span class="hljs-number">10000</span>)</span>:</span></span><br><span class="line">    M = <span class="hljs-number">3</span></span><br><span class="line">    cnt = <span class="hljs-number">0</span></span><br><span class="line">    samples = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">while</span> cnt &lt; N:</span><br><span class="line">        x = random.random()</span><br><span class="line">        acc_rate = f(x) / (M * g(x))</span><br><span class="line">        u = random.random()</span><br><span class="line">        <span class="hljs-keyword">if</span> acc_rate &gt;= u:</span><br><span class="line">            <span class="hljs-keyword">if</span> samples.get(x) == <span class="hljs-keyword">None</span>:</span><br><span class="line">                samples[x] = <span class="hljs-number">1</span></span><br><span class="line">            <span class="hljs-keyword">else</span>:</span><br><span class="line">                samples[x] = samples[x] + <span class="hljs-number">1</span></span><br><span class="line">            cnt = cnt + <span class="hljs-number">1</span></span><br><span class="line">            </span><br><span class="line">    <span class="hljs-keyword">return</span> samples</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = rejection_sampling(<span class="hljs-number">100000</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line"><span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> s.items():</span><br><span class="line">    X.append(k)</span><br><span class="line">    Y.append(v)</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.hist(X, bins=<span class="hljs-number">100</span>, edgecolor=<span class="hljs-string">'None'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105190002187-28177626.png" alt></p>
<h3 id="MCMC-Sampling"><a href="#MCMC-Sampling" class="headerlink" title="MCMC Sampling"></a>MCMC Sampling</h3><p><strong>Metropolis-Hastings Algorithm</strong></p>
<p>参考：<a href="https://blog.csdn.net/Dark_Scope/article/details/78937731" target="_blank" rel="noopener">MCMC相关算法介绍及代码实现</a></p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PI = <span class="hljs-number">3.1415926</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_p</span><span class="hljs-params">(x)</span>:</span></span><br><span class="line">    <span class="hljs-comment"># 模拟pi函数</span></span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>/(<span class="hljs-number">2</span>*PI)*np.exp(- x[<span class="hljs-number">0</span>]**<span class="hljs-number">2</span> - x[<span class="hljs-number">1</span>]**<span class="hljs-number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_tilde_p</span><span class="hljs-params">(x)</span>:</span></span><br><span class="line">    <span class="hljs-comment"># 模拟不知道怎么计算Z的PI，20这个值对于外部采样算法来说是未知的，对外只暴露这个函数结果</span></span><br><span class="line">    <span class="hljs-keyword">return</span> get_p(x)</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">domain_random</span><span class="hljs-params">()</span>:</span> <span class="hljs-comment">#计算定义域一个随机值</span></span><br><span class="line">    <span class="hljs-keyword">return</span> np.random.random()*<span class="hljs-number">3.8</span><span class="hljs-number">-1.9</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">metropolis</span><span class="hljs-params">(x)</span>:</span></span><br><span class="line">    new_x = (domain_random(),domain_random()) <span class="hljs-comment">#新状态</span></span><br><span class="line">    <span class="hljs-comment">#计算接收概率</span></span><br><span class="line">    acc = min(<span class="hljs-number">1</span>,get_tilde_p((new_x[<span class="hljs-number">0</span>],new_x[<span class="hljs-number">1</span>]))/get_tilde_p((x[<span class="hljs-number">0</span>],x[<span class="hljs-number">1</span>])))</span><br><span class="line">    <span class="hljs-comment">#使用一个随机数判断是否接受</span></span><br><span class="line">    u = np.random.random()</span><br><span class="line">    <span class="hljs-keyword">if</span> u&lt;acc:</span><br><span class="line">        <span class="hljs-keyword">return</span> new_x</span><br><span class="line">    <span class="hljs-keyword">return</span> x</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">testMetropolis</span><span class="hljs-params">(counts = <span class="hljs-number">100</span>,drawPath = False)</span>:</span></span><br><span class="line">    plt.figure()</span><br><span class="line">    <span class="hljs-comment">#主要逻辑</span></span><br><span class="line">    x = (domain_random(),domain_random()) <span class="hljs-comment">#x0</span></span><br><span class="line">    xs = [x] <span class="hljs-comment">#采样状态序列</span></span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(counts):</span><br><span class="line">        xs.append(x)</span><br><span class="line">        x = metropolis(x) <span class="hljs-comment">#采样并判断是否接受</span></span><br><span class="line">    <span class="hljs-comment">#在各个状态之间绘制跳转的线条帮助可视化</span></span><br><span class="line">    X1 = [x[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xs]</span><br><span class="line">    X2 = [x[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xs]</span><br><span class="line">    <span class="hljs-keyword">if</span> drawPath: </span><br><span class="line">        plt.plot(X1, X2, <span class="hljs-string">'k-'</span>,linewidth=<span class="hljs-number">0.5</span>)</span><br><span class="line">    <span class="hljs-comment">##绘制采样的点</span></span><br><span class="line">    plt.scatter(X1, X2, c = <span class="hljs-string">'g'</span>,marker=<span class="hljs-string">'.'</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">testMetropolis(<span class="hljs-number">5000</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105190015327-958250173.png" alt></p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">metropolis</span><span class="hljs-params">(x)</span>:</span></span><br><span class="line">    new_x = domain_random()</span><br><span class="line">    <span class="hljs-comment">#计算接收概率</span></span><br><span class="line">    acc = min(<span class="hljs-number">1</span>,f(new_x)/f(x))</span><br><span class="line">    <span class="hljs-comment">#使用一个随机数判断是否接受</span></span><br><span class="line">    u = np.random.random()</span><br><span class="line">    <span class="hljs-keyword">if</span> u&lt;acc:</span><br><span class="line">        <span class="hljs-keyword">return</span> new_x</span><br><span class="line">    <span class="hljs-keyword">return</span> x</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">testMetropolis</span><span class="hljs-params">(counts = <span class="hljs-number">100</span>,drawPath = False)</span>:</span></span><br><span class="line">    plt.figure()</span><br><span class="line">    <span class="hljs-comment">#主要逻辑</span></span><br><span class="line">    x = domain_random()</span><br><span class="line">    xs = [x] <span class="hljs-comment">#采样状态序列</span></span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(counts):</span><br><span class="line">        xs.append(x)</span><br><span class="line">        x = metropolis(x) <span class="hljs-comment">#采样并判断是否接受</span></span><br><span class="line">    <span class="hljs-comment">#在各个状态之间绘制跳转的线条帮助可视化</span></span><br><span class="line">    plt.hist(xs, bins=<span class="hljs-number">100</span>, edgecolor=<span class="hljs-string">'None'</span>)  </span><br><span class="line"><span class="hljs-comment">#     plt.plot(xs)</span></span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">testMetropolis(<span class="hljs-number">100000</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105190047964-1071205782.png" alt></p>
<h3 id="Gibbs-Sampling"><a href="#Gibbs-Sampling" class="headerlink" title="Gibbs Sampling"></a>Gibbs Sampling</h3><figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">partialSampler</span><span class="hljs-params">(x,dim)</span>:</span></span><br><span class="line">    xes = []</span><br><span class="line">    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>): <span class="hljs-comment">#随机选择10个点</span></span><br><span class="line">        xes.append(domain_random())</span><br><span class="line">    tilde_ps = []</span><br><span class="line">    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>): <span class="hljs-comment">#计算这10个点的未归一化的概率密度值</span></span><br><span class="line">        tmpx = x[:]</span><br><span class="line">        tmpx[dim] = xes[t]</span><br><span class="line">        tilde_ps.append(get_tilde_p(tmpx))</span><br><span class="line">    <span class="hljs-comment">#在这10个点上进行归一化操作，然后按照概率进行选择。</span></span><br><span class="line">    norm_tilde_ps = np.asarray(tilde_ps)/sum(tilde_ps)</span><br><span class="line">    u = np.random.random()</span><br><span class="line">    sums = <span class="hljs-number">0.0</span></span><br><span class="line">    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):</span><br><span class="line">        sums += norm_tilde_ps[t]</span><br><span class="line">        <span class="hljs-keyword">if</span> sums&gt;=u:</span><br><span class="line">            <span class="hljs-keyword">return</span> xes[t]</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gibbs</span><span class="hljs-params">(x)</span>:</span></span><br><span class="line">    rst = np.asarray(x)[:]</span><br><span class="line">    path = [(x[<span class="hljs-number">0</span>],x[<span class="hljs-number">1</span>])]</span><br><span class="line">    <span class="hljs-keyword">for</span> dim <span class="hljs-keyword">in</span> range(<span class="hljs-number">2</span>): <span class="hljs-comment">#维度轮询，这里加入随机也是可以的。</span></span><br><span class="line">        new_value = partialSampler(rst,dim)</span><br><span class="line">        rst[dim] = new_value</span><br><span class="line">        path.append([rst[<span class="hljs-number">0</span>],rst[<span class="hljs-number">1</span>]])</span><br><span class="line">    <span class="hljs-comment">#这里最终只画出一轮轮询之后的点，但会把路径都画出来</span></span><br><span class="line">    <span class="hljs-keyword">return</span> rst,path</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">testGibbs</span><span class="hljs-params">(counts = <span class="hljs-number">100</span>,drawPath = False)</span>:</span></span><br><span class="line">    plt.figure()</span><br><span class="line"></span><br><span class="line">    x = (domain_random(),domain_random())</span><br><span class="line">    xs = [x]</span><br><span class="line">    paths = [x]</span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(counts):</span><br><span class="line">        xs.append([x[<span class="hljs-number">0</span>],x[<span class="hljs-number">1</span>]])</span><br><span class="line">        x,path = gibbs(x)</span><br><span class="line">        paths.extend(path) <span class="hljs-comment">#存储路径</span></span><br><span class="line">        </span><br><span class="line">    p1 = [x[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> paths]</span><br><span class="line">    p2 = [x[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> paths]</span><br><span class="line">    xs1 = [x[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xs]</span><br><span class="line">    xs2 = [x[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> xs]</span><br><span class="line">    <span class="hljs-keyword">if</span> drawPath: </span><br><span class="line">        plt.plot(p1, p2, <span class="hljs-string">'k-'</span>,linewidth=<span class="hljs-number">0.5</span>)</span><br><span class="line">    <span class="hljs-comment">##绘制采样的点</span></span><br><span class="line">    plt.scatter(xs1, xs2, c = <span class="hljs-string">'g'</span>,marker=<span class="hljs-string">'.'</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">testGibbs(<span class="hljs-number">5000</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img2018.cnblogs.com/blog/1019353/201901/1019353-20190105190055812-1550383359.png" alt></p>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/samples/">采样</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3>
        <div class="buttons is-centered">
            
                
<a class="button is-info donate">
    <span class="icon is-small">
        <i class="fab fa-alipay"></i>
    </span>
    <span>支付宝</span>
    <div class="qrcode"><img src="/images/alipay.png" alt="支付宝"></div>
</a>

                
                
<a class="button is-success donate">
    <span class="icon is-small">
        <i class="fab fa-weixin"></i>
    </span>
    <span>微信</span>
    <div class="qrcode"><img src="/images/wechat.png" alt="微信"></div>
</a>

                
        </div>
    </div>
</div>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/categories/computer-vision/Post-Tuned-Hashing，PTH/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">Post Tuned Hashing，PTH</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/categories/computer-vision/Supervised-Hashing-with-Kernels-KSH/">
                <span class="level-item">Supervised Hashing with Kernels, KSH</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">评论</h3>
        
<div id="comment-container"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.4.1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.4.1/dist/gitalk.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
    var gitalk = new Gitalk({
        clientID: 'e5eff8aa39f563a204e5',
        clientSecret: '8adc001af75f722b72813ab2916f65f6b7ba3da0',
        id: 'e605c8a7162a194e8db2f9835f3bfba2',
        repo: 'chenshen03.github.io',
        owner: 'chenshen03',
        admin: "chenshen03"
    })
    gitalk.render('comment-container')
</script>

    </div>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                        <img class="image is-128x128 has-mb-6" src="/images/avatar.png" alt="陈燊">
                    
                    
                    <p class="is-size-4 is-block">
                        陈燊
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Master student of Computer Science
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Xiamen, China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div style="cursor: pointer;" onclick="window.open('/archives','_self')">
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        74
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div style="cursor: pointer;" onclick="window.open('/categories','_self')">
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        8
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div style="cursor: pointer;" onclick="window.open('/tags','_self')">
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        38
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/chenshen03">
                关注我</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Github" href="https://github.com/chenshen03">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Cnblogs" href="https://www.cnblogs.com/cslaker">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Weibo" href="https://www.weibo.com/cstobeno1">
                
                <i class="fab fa-weibo"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Facebook" href="https://www.facebook.com/chenshen03">
                
                <i class="fab fa-facebook-f"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Zhihu" href="https://www.zhihu.com/people/chenshen03">
                
                <i class="fab fa-zhihu"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
<div class="card widget" id="toc">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                目录
            </h3>
            <ul class="menu-list"><li>
        <a class="is-flex" href="#直接采样">
        <span class="has-mr-6">1</span>
        <span>直接采样</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#局限性">
        <span class="has-mr-6">1.1</span>
        <span>局限性</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#拒绝采样">
        <span class="has-mr-6">2</span>
        <span>拒绝采样</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#计算步骤">
        <span class="has-mr-6">2.1</span>
        <span>计算步骤</span>
        </a></li><li>
        <a class="is-flex" href="#计算步骤（BN）">
        <span class="has-mr-6">2.2</span>
        <span>计算步骤（BN）</span>
        </a></li><li>
        <a class="is-flex" href="#局限性-1">
        <span class="has-mr-6">2.3</span>
        <span>局限性</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#重要性采样（似然加权）">
        <span class="has-mr-6">3</span>
        <span>重要性采样（似然加权）</span>
        </a></li><li>
        <a class="is-flex" href="#吉布斯采样">
        <span class="has-mr-6">4</span>
        <span>吉布斯采样</span>
        </a></li><li>
        <a class="is-flex" href="#蓄水池采样">
        <span class="has-mr-6">5</span>
        <span>蓄水池采样</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#算法步骤：">
        <span class="has-mr-6">5.1</span>
        <span>算法步骤：</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#MCMC算法">
        <span class="has-mr-6">6</span>
        <span>MCMC算法</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#马氏链收敛定理">
        <span class="has-mr-6">6.1</span>
        <span>马氏链收敛定理</span>
        </a></li><li>
        <a class="is-flex" href="#细致平稳条件">
        <span class="has-mr-6">6.2</span>
        <span>细致平稳条件</span>
        </a></li><li>
        <a class="is-flex" href="#Metropolis-Hastings采样">
        <span class="has-mr-6">6.3</span>
        <span>Metropolis-Hastings采样</span>
        </a></li><li>
        <a class="is-flex" href="#疑问">
        <span class="has-mr-6">6.4</span>
        <span>疑问</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#代码">
        <span class="has-mr-6">7</span>
        <span>代码</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#Rejection-Sampling">
        <span class="has-mr-6">7.1</span>
        <span>Rejection Sampling</span>
        </a></li><li>
        <a class="is-flex" href="#MCMC-Sampling">
        <span class="has-mr-6">7.2</span>
        <span>MCMC Sampling</span>
        </a></li><li>
        <a class="is-flex" href="#Gibbs-Sampling">
        <span class="has-mr-6">7.3</span>
        <span>Gibbs Sampling</span>
        </a></li></ul></li></ul>
        </div>
    </div>
</div>

    
        
    
    
        <div class="column-right-shadow  ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/CUDA/" style="font-size: 10px;">CUDA</a> <a href="/tags/Jupyter/" style="font-size: 10px;">Jupyter</a> <a href="/tags/Leetcode/" style="font-size: 10px;">Leetcode</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/POJ/" style="font-size: 20px;">POJ</a> <a href="/tags/人脸识别/" style="font-size: 10px;">人脸识别</a> <a href="/tags/fourier-transform/" style="font-size: 10px;">傅里叶变换</a> <a href="/tags/dynamic-planning/" style="font-size: 14.29px;">动态规划</a> <a href="/tags/kalman-filter/" style="font-size: 10px;">卡尔曼滤波</a> <a href="/tags/cnn/" style="font-size: 10px;">卷积神经网络</a> <a href="/tags/hash/" style="font-size: 15.71px;">哈希</a> <a href="/tags/image-feature/" style="font-size: 10px;">图像特征</a> <a href="/tags/graph/" style="font-size: 12.86px;">图论</a> <a href="/tags/mean-shift/" style="font-size: 10px;">均值漂移</a> <a href="/tags/reinforcement-learning/" style="font-size: 10px;">强化学习</a> <a href="/tags/rnn/" style="font-size: 10px;">循环神经网络</a> <a href="/tags/sort/" style="font-size: 10px;">排序</a> <a href="/tags/search/" style="font-size: 17.14px;">搜索</a> <a href="/tags/svm/" style="font-size: 11.43px;">支持向量机</a> <a href="/tags/unsupervised-hash/" style="font-size: 12.86px;">无监督哈希</a> <a href="/tags/temporal-reasoning/" style="font-size: 11.43px;">时序推理</a> <a href="/tags/时序推理，隐马尔可夫/" style="font-size: 10px;">时序推理，隐马尔可夫</a> <a href="/tags/naive-bayes/" style="font-size: 11.43px;">朴素贝叶斯</a> <a href="/tags/kernel-function/" style="font-size: 10px;">核函数</a> <a href="/tags/gradient-descent/" style="font-size: 10px;">梯度下降</a> <a href="/tags/deep-hash/" style="font-size: 11.43px;">深度哈希</a> <a href="/tags/filter/" style="font-size: 12.86px;">滤波</a> <a href="/tags/supervised-hash/" style="font-size: 11.43px;">监督哈希</a> <a href="/tags/object-track/" style="font-size: 10px;">目标跟踪</a> <a href="/tags/neural-network/" style="font-size: 18.57px;">神经网络</a> <a href="/tags/particle-filter/" style="font-size: 10px;">粒子滤波</a> <a href="/tags/nlp/" style="font-size: 10px;">自然语言处理</a> <a href="/tags/semantic-segmentation/" style="font-size: 10px;">语义分割</a> <a href="/tags/bayesian-network/" style="font-size: 10px;">贝叶斯网络</a> <a href="/tags/greedy-lgorithm/" style="font-size: 17.14px;">贪心算法</a> <a href="/tags/edge-detection/" style="font-size: 10px;">边缘检测</a> <a href="/tags/samples/" style="font-size: 11.43px;">采样</a> <a href="/tags/zero-shot-learning/" style="font-size: 10px;">零样本学习</a>
    </div>
</div>

        
            
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/study/">
            <span class="level-start">
                <span class="level-item">学习</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/technique/">
            <span class="level-start">
                <span class="level-item">技术</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/machine-learning/">
            <span class="level-start">
                <span class="level-item">机器学习</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">11</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/deep-learning/">
            <span class="level-start">
                <span class="level-item">深度学习</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">10</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/algorithms/">
            <span class="level-start">
                <span class="level-item">算法与数据结构</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">23</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/computer-vision/">
            <span class="level-start">
                <span class="level-item">计算机视觉</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">10</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/software-engineering/">
            <span class="level-start">
                <span class="level-item">软件工程</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/essay/">
            <span class="level-start">
                <span class="level-item">随笔</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
        
            
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="MCMC等采样算法" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 陈燊&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                共<span id="busuanzi_value_site_uv">0</span>个访客
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="GitHub" href="https://github.com/chenshen03">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>